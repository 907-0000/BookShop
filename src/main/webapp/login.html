<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>书城登录</title>
		<link rel="stylesheet" href="css/bootstrap.css">
		<link rel="stylesheet" href="css/bootoast.css">
		<!-- 导入包 -->
		<script src="js/jquery-3.6.0.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/bootstrap.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/bootoast.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			body{
				/* background: url(img/bg.png); */
				background: url(img/bg.png);
				/* background: rgba(255, 255, 255, 0.5); */
			}
			
			.login{
				/* background: rgba(238, 238, 238, 0.85); */
				background:#ffffff;
				border: 2px solid gainsboro;
				margin-top: 180px;
				border-radius: 10px;
				padding: 25px;
			}
	
			
			.login .input-group{
				margin: 15px 0px;
			}
			.login .code-box{
				   position: relative;
			}
			.code-box img{
				   width: 80px;
				   height: 40px;
				   position: absolute;
				   top: 2px;
				   right: 2px;
				   bottom: 2px;
				   border: 1px solid #eee;
				   z-index: 999;
				   cursor: pointer;
			}
			
		</style>
	</head>
	<body>
		<script type="text/javascript">
			$(function(){
				//验证码获取
				$('#imgCode').attr('src','/bookshop/captcha');
				$('#imgCode').click(function (){
					$('#imgCode').attr('src','/bookshop/captcha?d='+new Date().getTime());
				});
				$('#log').click(function(){
					//验证表单输入是否合法
					if(!validForm()){
						return false;
					}
					//访问cotrol获得数据
					$.ajax({
						type:'post',
						url:'login',
						cache:false,
						data:$("#logIn").serialize(),
						dataType:'json',
						success:function (rst){
							if (rst.code == -1){
								bootoast({
									message:rst.msg,
									type:'danger',
									position:'top',
									timeout:2,
								});
							}else{//成功
								bootoast({
									message:rst.msg,
									type:'success',
									position:'top',
									timeout:2,
								});
								//将用户存放在
								sessionStorage.setItem("adminId",rst.data.adminId);
								sessionStorage.setItem("nickName",rst.data.nickName);

								sessionStorage.setItem("admin",JSON.stringify(rst.data));
								setTimeout(function (){
									location.href="home.html";
								},2000);
							}

						},
						error:function (error){
							bootoast({
								message: '服务器请求错误',
								type: 'danger',
								position: 'top',
								timeout: 2
							});
						}
					});
					// //跳转页面
					// location.href="home.html";
				});
			});
			function validForm(){
				var accout=$('#account').val();
				var paws=$('#paws').val();
				var code=$('#code').val();
				if(accout==''){
					bootoast({
					message:'账号或手机必须输入',
					type:'danger',
					position:'top',
					timeout:2
					});
					return false;
				}
				if(pass==''){
					bootoast({
					message:'密码必须输入',
					type:'danger',
					position:'top',
					timeout:2
					});
					return false;
				}
				if(code==''){
					bootoast({
						message:'验证码必须输入',
						type:'danger',
						position:'top',
						timeout:2
					});
					return false;
				}
				
				return true;
			}
		</script>
		
			
		
		<div class="container-fluid">
			<div class="row">
				<div class="col-sm-4 col col-sm-offset-4 login">
					<h2 class="text-center">欢迎登录书城</h2>
					<form id="logIn">
						<div class="input-group form-group-lg">
							<span class="input-group-addon">账号</span>
							<input type="text" name="account" id="account" class="form-control" placeholder="请输入手机号">
							
						</div>
						<div class="input-group form-group-lg">
							<span class="input-group-addon ">密码</span>
							<input type="text" name="pass" id="pass" class="form-control" placeholder="请输入密码">
						</div>
					
					<div class="form-group form-group-lg">
								   <div class="input-group code-box">
					      <span class="input-group-addon">验证</span>
					      <input type="text" name="code" id="code" class="form-control" placeholder="请输入验证码"/>
									 
									 <img id="imgCode" alt="获取失败"/>
					    </div>
								</div>
						<div class="form-group form-group-lg">
							<div class="checkbox">
								<label for="" style="color: #000;">
									<input type="checkbox">记住密码
								</label>
							</div>
						<div class="text-center ">
							<!-- <button class="btn btn-success" id="log">登录</button> -->
							<input type="button" class="btn btn-success btn-lg" id="log" value="登录">
						</div>
						
						</div>
						

					</form>
				</div>
			</div>
		</div>
	
		
	</body>
</html>
